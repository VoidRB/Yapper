datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["deno"]
  output          = "../generated/client"
  engineType      = "binary"
}

model User {
  id        Int      @id @default(autoincrement())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  email        String @unique
  passwordHash String

  sessions         Session[]
  recievedMessages Message[] @relation("RecievedMessages")
  sentMessages     Message[] @relation("SentMessages")
}

model Session {
  id        Int      @id @default(autoincrement())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  ip        String
  userAgent String
  token     String @unique

  userId Int
  user   User @relation(fields: [userId], references: [id])
}

model Message {
  id        Int      @id @default(autoincrement())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  content String

  fromUserId Int
  fromUser   User @relation(fields: [fromUserId], references: [id], name: "RecievedMessages")
  toUserId   Int
  toUser     User @relation(fields: [toUserId], references: [id], name: "SentMessages")
}
